import csv

# 1. Read the CSV and convert it into a list of dictionaries
students = []
input_file = "student_marks.csv"
output_file = "student_marks_updated.csv"

try:
    with open(input_file, mode='r') as file:
        reader = csv.DictReader(file)
        for row in reader:
            # Convert marks to integers for calculation
            marks = [int(row[subject]) for subject in row if subject != "Name"]
            total = sum(marks)
            average = round(total / len(marks), 2)
            row['Total_Marks'] = total
            row['Average'] = average
            students.append(row)

    # 2. Write updated data into a new CSV file
    with open(output_file, mode='w', newline='') as file:
        fieldnames = list(students[0].keys())  # dynamic column names
        writer = csv.DictWriter(file, fieldnames=fieldnames)
        writer.writeheader()
        writer.writerows(students)

    print(f"✅ Data processed successfully. Updated file saved as '{output_file}'")

except FileNotFoundError:
    print(f"❌ File '{input_file}' not found. Please make sure it's in the same folder.")
